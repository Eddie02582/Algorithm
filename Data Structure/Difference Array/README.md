# ğŸ“Š å·®åˆ†é™£åˆ—ï¼ˆDifference Array / å·®åˆ†çŸ©é™£ï¼‰å®Œæ•´æ•™å­¸ï¼ˆPython + LeetCode ç¯„ä¾‹ï¼‰

å·®åˆ†é™£åˆ—æ˜¯ä¸€ç¨®ç”¨æ–¼é«˜æ•ˆè™•ç† **å€é–“åŠ æ¸›æ“ä½œ** çš„è³‡æ–™çµæ§‹ã€‚  
æ ¸å¿ƒæ€æƒ³ï¼š**å°‡å°ä¸€æ®µå€é–“çš„æ›´æ–°æ“ä½œè½‰åŒ–ç‚º O(1) çš„æ“ä½œ**ï¼Œæœ€å¾Œå†é€šéå‰ç¶´å’Œæ¢å¾©åŸæ•¸çµ„ã€‚

---

## 1ï¸âƒ£ åŸºæœ¬æ¦‚å¿µ

çµ¦å®šåŸå§‹é™£åˆ— `nums`ï¼š

```
nums = [0, 0, 0, 0, 0]
```

æˆ‘å€‘å®šç¾© **å·®åˆ†é™£åˆ— diff**ï¼š

- diff[0] = nums[0]  
- diff[i] = nums[i] - nums[i-1]ï¼Œi > 0  

ç›´è¦ºç†è§£ï¼š  
> diff[i] è¡¨ç¤ºå¾ nums[i-1] åˆ° nums[i] çš„ã€Œè®ŠåŒ–é‡ã€ã€‚

### ç¯„ä¾‹

```
nums = [1, 2, 3, 4, 5]
diff = [1, 1, 1, 1, 1]
```

- nums[0] = diff[0] = 1  
- nums[1] = nums[0] + diff[1] = 1 + 1 = 2  
- nums[2] = nums[1] + diff[2] = 2 + 1 = 3  

âœ… å¯ä»¥é€é diff å®Œå…¨é‚„åŸåŸé™£åˆ— numsã€‚

---

## 2ï¸âƒ£ å€é–“åŠ å€¼æ“ä½œ

ç›®æ¨™ï¼šå°é™£åˆ— `[l, r]` çš„æ¯å€‹å…ƒç´ åŠ ä¸Š valï¼ŒåŸæœ¬ O(n) æ›´æ–° â†’ å·®åˆ†é™£åˆ—åªéœ€ O(1) æ›´æ–°

```
diff[l] += val
if r+1 < n:
    diff[r+1] -= val
```

### ç¯„ä¾‹

åŸé™£åˆ—ï¼š

```
nums = [0, 0, 0, 0, 0]
æ“ä½œ: å°‡ [1,3] åŠ  2
```

å»ºç«‹å·®åˆ†é™£åˆ—ï¼š

```
diff = [0,0,0,0,0]
diff[1] += 2 => diff = [0,2,0,0,0]
diff[3+1] -= 2 => diff[4] -= 2 => diff = [0,2,0,0,-2]
```

é‚„åŸåŸé™£åˆ—ï¼š

```
nums[0] = diff[0] = 0
nums[1] = nums[0] + diff[1] = 0 + 2 = 2
nums[2] = nums[1] + diff[2] = 2 + 0 = 2
nums[3] = nums[2] + diff[3] = 2 + 0 = 2
nums[4] = nums[3] + diff[4] = 2 + (-2) = 0
```

çµæœï¼š

```
nums = [0,2,2,2,0]
```

> âœ… å€é–“æ›´æ–° O(1)ï¼Œå¤§å¹…æé«˜æ•ˆç‡

---

## 3ï¸âƒ£ Python å¯¦ä½œï¼ˆ1D å·®åˆ†é™£åˆ—ï¼‰

```python
def get_diff_array(nums):
    n = len(nums)
    diff = [0] * n
    diff[0] = nums[0]
    for i in range(1,n):
        diff[i] = nums[i] - nums[i-1]
    return diff

def apply_operations(nums, operations):
    n = len(nums)
    diff = get_diff_array(nums)
    
    for l,r,val in operations:
        diff[l] += val
        if r+1 < n:
            diff[r+1] -= val
    
    # é‚„åŸåŸé™£åˆ—
    res = [0]*n
    res[0] = diff[0]
    for i in range(1,n):
        res[i] = res[i-1] + diff[i]
    return res

# ç¯„ä¾‹
nums = [0,0,0,0,0]
ops = [(1,3,2),(2,4,3)]  # (l,r,val)
print(apply_operations(nums, ops))  # [0,2,5,5,3]
```

---

## 4ï¸âƒ£ äºŒç¶­å·®åˆ†çŸ©é™£ï¼ˆ2D Difference Arrayï¼‰

å°æ–¼çŸ©é™£ `matrix`ï¼Œè¦åœ¨çŸ©å½¢å€é–“ `[r1, c1] ~ [r2, c2]` åŠ ä¸Š valï¼š

```
diff[r1][c1] += val
diff[r1][c2+1] -= val
diff[r2+1][c1] -= val
diff[r2+1][c2+1] += val
```

æœ€å¾Œä½¿ç”¨äºŒç¶­å‰ç¶´å’Œæ¢å¾©åŸçŸ©é™£ï¼š

```python
for i in range(rows):
    for j in range(1,cols):
        diff[i][j] += diff[i][j-1]
for j in range(cols):
    for i in range(1,rows):
        diff[i][j] += diff[i-1][j]
```

### ç¯„ä¾‹è§£é‡‹

- diff[i][j] è¡¨ç¤ºçŸ©é™£å¾å·¦ä¸Šè§’åˆ° (i,j) çš„è®ŠåŒ–é‡  
- æ“ä½œå¾Œï¼Œé€éã€ŒäºŒç¶­å‰ç¶´å’Œã€æ¢å¾©æ•´å€‹çŸ©é™£  
- é©åˆå¤§é‡å€é–“çŸ©å½¢åŠ å€¼å•é¡Œ  

---

## 5ï¸âƒ£ LeetCode å¸¸è¦‹é¡Œç›®

| é¡Œè™Ÿ | é¡Œå | é›£åº¦ | èªªæ˜ |
|------|------|------|------|
| 1109 | Corporate Flight Bookings | Medium | å€é–“åŠ å€¼ â†’ å·®åˆ†é™£åˆ— |
| 370 | Range Addition | Easy | å€é–“åŠ å€¼ |
| 2536 | Increment Submatrices by One | Medium | äºŒç¶­å·®åˆ†çŸ©é™£ |
| 2710 | Remove Value From Matrix Queries | Medium | äºŒç¶­å·®åˆ†çŸ©é™£ |
| 2181 | Merge Nodes in Between Zeros | Medium | å€é–“æ±‚å’Œ |

---

## 6ï¸âƒ£ æ€ç¶­åœ–è§£

### ä¸€ç¶­å·®åˆ†

```
åŸé™£åˆ—: [0,0,0,0,0]
æ“ä½œ: [1,3]+2
å·®åˆ†: [0,2,0,0,-2]
é‚„åŸ: 0,0+2=2,2+0=2,2+0=2,2-2=0
```

### äºŒç¶­å·®åˆ†

```
æ“ä½œçŸ©å½¢åŠ 1ï¼š
diffçŸ©é™£åªæ›´æ–°å››å€‹è§’ï¼š
+1 top-left, -1 top-right+1, -1 bottom-left+1, +1 bottom-right+1
æœ€å¾Œç”¨äºŒç¶­å‰ç¶´å’Œæ¢å¾©åŸçŸ©é™£
```

---

## 7ï¸âƒ£ å­¸ç¿’å»ºè­°

1. å…ˆç†Ÿæ‚‰ **ä¸€ç¶­å·®åˆ†é™£åˆ—**ï¼Œç†è§£ diff[i] çš„æ„ç¾©  
2. ç·´ç¿’ **å€é–“åŠ å€¼æ“ä½œ**ï¼Œç†è§£ä¸Šé¢ O(1) çš„å„ªåŒ–  
3. å†å­¸ **äºŒç¶­å·®åˆ†çŸ©é™£**ï¼Œè™•ç†çŸ©å½¢å€é–“  
4. çµåˆ **LeetCode å€é–“åŠ å€¼é¡Œç›®**  
5. é©åˆ **å¤šæ¬¡å€é–“æ›´æ–°æˆ–å‹•æ…‹åŠ æ¸›å•é¡Œ**

---

âœ” å®Œæ•´å·®åˆ†é™£åˆ— Markdown æ•™å­¸ï¼ˆç›´è¦ºç†è§£ + Python å¯¦ä½œ + LeetCode ç¯„ä¾‹ï¼‰
